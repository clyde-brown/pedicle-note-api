# 페디클(Pedicle) 개인병원 특화 의료기록 시스템 MVP PRD

## 🎯 핵심 정보

**목적**: 개인병원의 진료 흐름을 해치지 않으면서 임상 사고를 구조화하고, 환자가 이해할 수 있는 형태로 설명 가능한 의료기록 시스템 구축
**사용자**: 개인병원 의사(Primary), 병원 관리자(Secondary), 재진 환자(Indirect)

## 🚶 사용자 여정 (Clinical & Admin Flow)

### 의사 여정

1. **로그인** → 병원(테넌트) 인증 후 진료 콘솔 진입
2. **환자 선택** → 대기 환자 목록에서 선택 또는 신규 환자 등록
3. **진료 시작** → 환자 대면 차팅 모드로 진입 (환자와 화면 공유 가능)
4. **문제 단위 차팅 (Problem Unit)**
   - 주증상 카드 생성 (부위, 좌우, 통증 정도만 빠르게 입력)
   - 필요시 맥락 정보 확장 (유발동작, 악화/완화 조건)
   - 재진인 경우 이전 문제 카드에 변화 내용만 추가
5. **S-T-D 기반 구조화**
   - Situation: 증상, 신체검사, 영상검사 결과 통합 입력
   - Treatment: 치료 계획 및 처방 (가설 상태 허용)
   - Duration: 예상 경과 및 재진 일정
6. **환자 설명** → 차팅 화면을 환자와 함께 보며 설명 (의학용어 자동 변환)
7. **ICD 자동 매핑** → 입력된 증상-부위 기반으로 후방에서 자동 처리
8. **진료 요약 생성** → 환자용 설명 자료 자동 생성 및 제공
9. **진료 종료** → 30초 이내 다음 환자 준비 가능

### 환자 관점 (간접 경험)

1. **진료실 입장** → 의사가 컴퓨터보다 환자를 더 많이 봄
2. **차팅 화면 공유** → 의사와 함께 화면을 보며 증상 위치와 상태 확인
3. **시각적 설명** → 복잡한 의학 정보를 이해하기 쉬운 형태로 확인
4. **진료 요약 수령** → 진료 후 가족에게 설명 가능한 수준의 요약 자료 획득
5. **재진 시** → 이전 진료 대비 변화를 명확히 확인

### 관리자 여정

1. **관리자 로그인** → 병원 관리 콘솔 진입
2. **초기 설정** → 병원 정보, 진료 과목, 주요 질환군 설정
3. **사용자 관리** → 의료진 계정 생성 및 권한 설정
4. **템플릿 관리** → 자주 사용하는 증상-부위 조합 사전 설정
5. **통계 확인** → 주요 질환별 통계, 진료 효율성 지표 모니터링
6. **데이터 품질 관리** → 미완성 차트, 누락 정보 추적

### 예외 흐름

1. **긴급 진료** → 최소 정보만 입력하고 나중에 보완 가능
2. **복잡한 케이스** → 여러 문제를 개별 카드로 분리 관리
3. **환자 질문 대응** → 차팅 중에도 환자 질문에 즉시 대응 가능한 UI
4. **시스템 장애** → 오프라인 모드로 임시 저장 후 동기화

## 📜 제품 핵심 규약 (정책 확정분만)

- **규약 1**: EMR을 대체하지 않으며, 임상 사고 보조 도구로서 기존 EMR과 병행 사용을 전제로 한다
- **규약 2**: 진료 흐름을 방해하는 어떤 필수 입력도 강제하지 않으며, 최소 입력으로 시작 가능하다
- **규약 3**: 모든 차팅 구조는 환자에게 설명 가능한 형태여야 하며, 의학 용어는 자동으로 일반 용어로 변환된다
- **규약 4**: 모든 데이터는 tenant_id 기반으로 완전 격리되며, 병원 간 데이터 교차 접근은 불가능하다
- **규약 5**: 동일 문제(Problem)는 여러 내원에 걸쳐 하나의 연속된 이력으로 관리된다
- **규약 6**: 원인과 진단은 가설 상태로 기록 가능하며, 확정되지 않은 상태를 그대로 유지할 수 있다
- **규약 7**: ICD 코드는 증상-부위 입력을 기반으로 자동 매핑되며, 의사는 직접 검색할 필요가 없다

## ⚡ 기능 명세 (Fxxx)

| ID                        | 기능명                 | 설명(기능 설명/S-T-D 영향)                                             | 관련 페이지     | 환자에게 주는 가치           |
| ------------------------- | ---------------------- | ---------------------------------------------------------------------- | --------------- | ---------------------------- |
| **인증 및 계정**    |                        |                                                                        |                 |                              |
| F001                      | 테넌트 인증            | JWT 기반 로그인 → 병원 컨텍스트 설정 / tenant_id 결정 / -             | 로그인          | 병원별 독립된 데이터 보호    |
| F014                      | 사용자 관리            | 의료진 계정 CRUD → 권한 할당 / tenant_id 격리 / -                     | 사용자 관리     | 신뢰할 수 있는 의료진의 진료 |
| **환자 관리**       |                        |                                                                        |                 |                              |
| F002                      | 환자 검색              | 이름/차트번호 검색 → 환자 목록 조회 / tenant_id 필터 / -              | 환자 목록       | 빠른 진료 시작               |
| F003                      | 환자 등록              | 신규 환자 정보 입력 → 환자 레코드 생성 / tenant_id 할당 / -           | 환자 등록       | 체계적인 의료 기록 시작      |
| **진료 핵심**       |                        |                                                                        |                 |                              |
| F004                      | Encounter 생성         | 진료 시작 → 새 진료 세션 오픈 / tenant_id 상속 / S-T-D 초기화         | 진료 차트       | 오늘의 진료 기록 시작        |
| F031                      | 환자 대면 차팅 모드    | 의사-환자가 함께 보는 간소화 화면 / tenant_id 격리 / -                 | 대면 차팅       | 진료 과정을 함께 확인        |
| F034                      | Problem Unit 관리      | 문제별 카드 생성 및 연속 관리 / tenant_id 격리 / S-T-D 통합            | 문제 관리       | 내 증상의 변화 추적          |
| F035                      | 재진 변화 비교         | 이전 내원 대비 변화 하이라이트 / tenant_id 필터 / -                    | 변화 비교       | 치료 효과를 명확히 확인      |
| **S축 - 상황 기록** |                        |                                                                        |                 |                              |
| F005                      | Situation 입력         | 증상/부위/onset 입력 → S축 데이터 저장 / tenant_id 격리 / S축 영향    | 진료 차트       | 내 증상의 정확한 기록        |
| F019                      | 신체검사 기록          | 이학적 검사 소견 입력 → S축 객관적 데이터 / tenant_id 격리 / S축 영향 | 신체검사        | 객관적 검사 결과 확인        |
| F020                      | ROM 측정               | 관절 가동범위 측정값 입력 / tenant_id 격리 / S축 영향                  | 신체검사        | 관절 상태 정량적 파악        |
| F021                      | 근력 평가              | 근력 등급(0-5) 입력 / tenant_id 격리 / S축 영향                        | 신체검사        | 근력 상태 객관적 평가        |
| F022                      | 특수검사 수행          | 특수검사 결과(양성/음성) 기록 / tenant_id 격리 / S축 영향              | 신체검사        | 특수 검사 결과 이해          |
| F023                      | 압통점 마킹            | 해부학적 위치에 압통점 표시 / tenant_id 격리 / S축 영향                | 신체검사        | 통증 부위 시각적 확인        |
| F024                      | 영상검사 오더          | 검사 처방 생성 / tenant_id 격리 / -                                    | 영상검사        | 필요한 검사 진행             |
| F025                      | 영상 판독 입력         | 판독 소견 구조화 입력 / tenant_id 격리 / S축 영향                      | 영상검사        | 영상 검사 결과 이해          |
| F026                      | 영상 시계열 비교       | 이전/현재 영상 비교 / tenant_id 격리 / S축 영향                        | 영상검사        | 영상 변화 추이 확인          |
| **T축 - 치료 계획** |                        |                                                                        |                 |                              |
| F006                      | Treatment 입력         | 치료 계획/처방 입력 → T축 데이터 저장 / tenant_id 격리 / T축 영향     | 진료 차트       | 치료 계획 명확한 이해        |
| **D축 - 경과 관리** |                        |                                                                        |                 |                              |
| F007                      | Duration 입력          | 경과/재진 일정 입력 → D축 데이터 저장 / tenant_id 격리 / D축 영향     | 진료 차트       | 예상 회복 기간 파악          |
| **진단 및 코드**    |                        |                                                                        |                 |                              |
| F008                      | ICD 자동 제안          | S-T 데이터 분석 → ICD 코드 후보 추출 / tenant_id 격리 / -             | 진료 차트       | 정확한 진단명 확인           |
| F009                      | ICD 수동 검색          | 키워드 검색 → ICD 코드 목록 조회 / 전역 데이터 / -                    | ICD 검색        | 표준 진단명 확인             |
| F010                      | ICD 코드 확정          | 제안/검색 결과 선택 → Encounter에 매핑 / tenant_id 격리 / -           | 진료 차트       | 확정된 진단 기록             |
| **임상 도구**       |                        |                                                                        |                 |                              |
| F011                      | 유사 환자 조회         | S-T-D 패턴 매칭 → 과거 케이스 조회 / tenant_id 필터 / -               | 유사 사례       | 유사 사례 기반 치료          |
| F029                      | 검사 결과 통합         | 모든 검사 결과 종합 표시 / tenant_id 격리 / S축 영향                   | 검사 통합       | 종합적인 건강 상태 파악      |
| F030                      | 이상소견 하이라이트    | 비정상 소견 자동 강조 / tenant_id 격리 / -                             | 검사 통합       | 주의 사항 즉시 인지          |
| **환자 소통**       |                        |                                                                        |                 |                              |
| F032                      | 환자 설명 자료 생성    | 차팅 내용을 환자용 언어로 변환 / tenant_id 격리 / -                    | 환자 설명       | 이해하기 쉬운 설명 자료      |
| F033                      | 진료 요약 PDF          | 진료 내용 요약 문서 생성 및 전송 / tenant_id 격리 / -                  | 진료 요약       | 집에서도 확인 가능한 기록    |
| **데이터 관리**     |                        |                                                                        |                 |                              |
| F012                      | 진료 기록 저장         | 차트 확정 → 데이터 영속화 + Audit / tenant_id 격리 / S-T-D 확정       | 진료 차트       | 안전한 진료 기록 보관        |
| F013                      | 진료 기록 수정         | 기존 차트 편집 → 변경사항 저장 / tenant_id 격리 / S-T-D 변경          | 진료 차트       | 정확한 기록 유지             |
| F017                      | Audit Trail 조회       | 변경 이력 검색 → 로그 목록 표시 / tenant_id 필터 / -                  | 감사 로그       | 투명한 기록 관리             |
| F040                      | 데이터 내보내기        | EMR 연동용 데이터 추출 / tenant_id 필터 / -                            | 데이터 관리     | 기존 시스템과 연계           |
| **신체검사 구조화** |                        |                                                                        |                 |                              |
| F041                      | 정형외과 신체검사 템플릿 | 정형외과 특화 검사 항목 구조화 입력 / tenant_id 격리 / S축 영향       | 신체검사        | 체계적인 신체검사 결과 기록   |
| F042                      | ROM 범위 정상치 비교   | 관절 가동범위 측정값과 정상 범위 비교 / tenant_id 격리 / S축 영향      | 신체검사        | 관절 상태 정상 여부 즉시 파악 |
| F043                      | 근력/감각 평가 매핑    | 근력(0-5등급) 및 감각 검사 해부학적 매핑 / tenant_id 격리 / S축 영향    | 신체검사        | 신경학적 이상 부위 시각화     |
| F044                      | 특수검사 결과 추적     | 특수검사별 양성/음성 결과 시계열 추적 / tenant_id 격리 / S축 영향      | 신체검사        | 검사 결과 변화 추이 확인      |
| F045                      | 이전 신체검사 비교     | 동일 검사 항목 이전 결과와 자동 비교 / tenant_id 격리 / S축 영향       | 신체검사        | 치료 후 신체 기능 개선 확인   |
| **영상검사 관리**   |                        |                                                                        |                 |                              |
| F046                      | 영상검사 메타데이터 관리 | X-ray/CT/MRI 검사 정보 및 파일 링크 저장 / tenant_id 격리 / S축 영향  | 영상검사        | 영상 검사 이력 체계적 관리    |
| F047                      | 구조화 판독 입력       | 부위별 소견을 구조화 양식으로 입력 / tenant_id 격리 / S축 영향         | 영상검사        | 판독 소견 명확한 이해         |
| F048                      | 영상 판독 템플릿       | 자주 사용하는 판독 소견 템플릿 관리 / tenant_id 격리 / -               | 영상검사        | 일관된 판독 소견 작성         |
| F049                      | 시계열 영상 비교 뷰    | 동일 부위 과거-현재 영상 나란히 비교 / tenant_id 격리 / S축 영향      | 영상검사        | 병변 진행/호전 시각적 확인   |
| F050                      | 영상 소견 자동 하이라이트 | 비정상 소견 키워드 자동 강조 표시 / tenant_id 격리 / S축 영향        | 영상검사        | 중요 소견 즉시 인지          |
| **마스터 데이터**   |                        |                                                                        |                 |                              |
| F051                      | 정형외과 증상 마스터 관리 | 정형외과 특화 증상 50개 분류 체계 / tenant_id 격리 / S축 영향         | 마스터 관리     | 증상 정확한 분류 및 기록     |
| F052                      | 해부학적 부위 마스터 관리 | 정형외과 해부학적 부위 50개 세분화 체계 / tenant_id 격리 / S축 영향   | 마스터 관리     | 부위 정확한 특정 및 기록     |
| F053                      | 증상/부위 실시간 검색     | 자동완성 및 필터링으로 빠른 선택 / tenant_id 격리 / -                 | 모든 차팅 화면  | 빠르고 정확한 증상 입력      |
| F054                      | 자주 사용 항목 즐겨찾기   | 개인별 자주 사용 증상/부위 바로가기 / tenant_id + user_id 격리 / -    | 모든 차팅 화면  | 개인화된 빠른 차팅 환경      |
| F055                      | 증상-부위 연관성 제안     | 입력한 증상에 따른 관련 부위 자동 제안 / tenant_id 격리 / S축 영향    | 진료 차팅       | 놓칠 수 있는 관련 부위 확인  |
| F056                      | 부위별 기본 검사 템플릿   | 부위 선택 시 권장 신체검사 항목 자동 제안 / tenant_id 격리 / S축 영향 | 신체검사        | 체계적이고 완성도 높은 검사  |
| **병원 관리**       |                        |                                                                        |                 |                              |
| F015                      | 마스터 데이터 관리     | 템플릿 및 선택지 설정 / tenant_id 격리 / -                             | 마스터 설정     | 병원 특화 진료 환경          |
| F016                      | 진료 통계 조회         | 기간/의사/상병별 집계 / tenant_id 필터 / -                             | 통계 대시보드   | 진료 품질 향상               |
| F018                      | 데이터 품질 검토       | 미완성/미매핑 차트 탐지 / tenant_id 필터 / -                           | 품질 모니터링   | 완성도 높은 진료 기록        |
| **B2B SaaS 기능**   |                        |                                                                        |                 |                              |
| F036                      | 테넌트 생성 및 관리    | 병원 등록/설정 / 신규 tenant_id 생성 / -                               | 병원 관리       | 독립적인 병원 환경           |
| F037                      | 요금제 및 결제         | 구독 관리 및 결제 처리 / tenant_id 연계 / -                            | 결제 관리       | 안정적인 서비스 이용         |
| F038                      | 시스템 사용량 모니터링 | 리소스 사용 현황 추적 / tenant_id별 집계 / -                           | 시스템 모니터링 | 효율적인 자원 활용           |
| F039                      | 백업 및 복원           | 데이터 백업/복원 / tenant_id 단위 / -                                  | 백업 관리       | 안전한 데이터 보호           |

## 🧭 메뉴 구조

```
📱 Physician Console (의사 진료 콘솔)
│
├── 🏠 대시보드
│   ├── 오늘의 진료 현황
│   │   └── 기능: F016 (진료 통계 조회)
│   ├── 대기 환자 목록
│   │   └── 기능: F002 (환자 검색)
│   └── 재진 예정 목록
│       └── 기능: F007 (Duration 입력)
│
├── 👥 환자 관리
│   ├── 환자 검색
│   │   └── 기능: F002 (환자 검색)
│   ├── 신규 환자 등록
│   │   └── 기능: F003 (환자 등록)
│   └── Problem 이력 관리
│       ├── 기능: F034 (Problem Unit 관리)
│       └── 기능: F035 (재진 변화 비교)
│
├── 📝 진료 차팅 (핵심 기능)
│   ├── 진료 시작
│   │   ├── 기능: F004 (Encounter 생성)
│   │   └── 기능: F031 (환자 대면 차팅 모드)
│   ├── Problem 중심 차팅
│   │   ├── 기능: F034 (Problem Unit 관리)
│   │   ├── 기능: F005 (Situation 입력)
│   │   ├── 기능: F006 (Treatment 입력)
│   │   └── 기능: F007 (Duration 입력)
│   ├── 재진 변화 관리
│   │   └── 기능: F035 (재진 변화 비교)
│   └── 진료 저장
│       ├── 기능: F012 (진료 기록 저장)
│       └── 기능: F013 (진료 기록 수정)
│
├── 🩺 검사 관리
│   ├── 신체검사
│   │   ├── 기능: F019 (신체검사 기록)
│   │   ├── 기능: F041 (정형외과 신체검사 템플릿)
│   │   ├── 기능: F020 (ROM 측정) + F042 (ROM 범위 정상치 비교)
│   │   ├── 기능: F021 (근력 평가) + F043 (근력/감각 평가 매핑)
│   │   ├── 기능: F022 (특수검사 수행) + F044 (특수검사 결과 추적)
│   │   ├── 기능: F023 (압통점 마킹)
│   │   ├── 기능: F045 (이전 신체검사 비교)
│   │   └── 기능: F056 (부위별 기본 검사 템플릿)
│   ├── 영상검사
│   │   ├── 기능: F024 (영상검사 오더)
│   │   ├── 기능: F046 (영상검사 메타데이터 관리)
│   │   ├── 기능: F025 (영상 판독 입력) + F047 (구조화 판독 입력)
│   │   ├── 기능: F048 (영상 판독 템플릿)
│   │   ├── 기능: F026 (영상 시계열 비교) + F049 (시계열 영상 비교 뷰)
│   │   └── 기능: F050 (영상 소견 자동 하이라이트)
│   └── 검사 결과 통합
│       ├── 기능: F029 (검사 결과 통합)
│       └── 기능: F030 (이상소견 하이라이트)
│
├── 💬 환자 소통
│   ├── 환자 설명 화면
│   │   └── 기능: F032 (환자 설명 자료 생성)
│   └── 진료 요약 발송
│       └── 기능: F033 (진료 요약 PDF)
│
├── 🔍 임상 지원
│   ├── 유사 사례 검색
│   │   └── 기능: F011 (유사 환자 조회)
│   ├── ICD 코드 관리
│   │   ├── 기능: F008 (ICD 자동 제안)
│   │   ├── 기능: F009 (ICD 수동 검색)
│   │   └── 기능: F010 (ICD 코드 확정)
│   └── 진료 이력 조회
│       └── 기능: F017 (Audit Trail 조회)
│
└── ⚙️ 내 설정
    ├── 프로필 관리
    │   └── 기능: F001 (테넌트 인증)
    └── 로그아웃

📊 Admin Console (병원 관리 콘솔)
│
├── 🏥 병원 관리
│   ├── 병원 정보 설정
│   │   └── 기능: F036 (테넌트 생성 및 관리)
│   ├── 진료 과목 관리
│   │   └── 기능: F015 (마스터 데이터 관리)
│   └── 운영 시간 설정
│       └── 기능: F036 (테넌트 생성 및 관리)
│
├── 👨‍⚕️ 사용자 관리
│   ├── 의료진 관리
│   │   └── 기능: F014 (사용자 관리)
│   ├── 권한 설정
│   │   └── 기능: F014 (사용자 관리)
│   └── 접속 이력
│       └── 기능: F017 (Audit Trail 조회)
│
├── 📋 마스터 데이터 관리
│   ├── 증상 마스터
│   │   ├── 기능: F051 (정형외과 증상 마스터 관리)
│   │   └── 기능: F055 (증상-부위 연관성 제안)
│   ├── 해부학적 부위 마스터
│   │   ├── 기능: F052 (해부학적 부위 마스터 관리)
│   │   └── 기능: F056 (부위별 기본 검사 템플릿)
│   ├── 개인화 설정
│   │   ├── 기능: F054 (자주 사용 항목 즐겨찾기)
│   │   └── 기능: F053 (증상/부위 실시간 검색)
│   └── 템플릿 관리
│       ├── 기능: F015 (마스터 데이터 관리)
│       ├── 기능: F041 (정형외과 신체검사 템플릿)
│       └── 기능: F048 (영상 판독 템플릿)
│
├── 📈 통계 및 분석
│   ├── 진료 통계
│   │   └── 기능: F016 (진료 통계 조회)
│   ├── 질환별 분석
│   │   └── 기능: F016 (진료 통계 조회)
│   ├── 의사별 성과
│   │   └── 기능: F016 (진료 통계 조회)
│   └── 데이터 품질
│       └── 기능: F018 (데이터 품질 검토)
│
├── 💾 데이터 관리
│   ├── 백업 설정
│   │   └── 기능: F039 (백업 및 복원)
│   ├── 데이터 내보내기
│   │   └── 기능: F040 (데이터 내보내기)
│   └── EMR 연동
│       └── 기능: F040 (데이터 내보내기)
│
├── 💳 구독 관리
│   ├── 현재 요금제
│   │   └── 기능: F037 (요금제 및 결제)
│   ├── 사용량 현황
│   │   └── 기능: F038 (시스템 사용량 모니터링)
│   └── 결제 관리
│       └── 기능: F037 (요금제 및 결제)
│
└── 🔒 보안 및 감사
    ├── 접근 로그
    │   └── 기능: F017 (Audit Trail 조회)
    ├── 데이터 변경 이력
    │   └── 기능: F017 (Audit Trail 조회)
    └── 보안 설정
        └── 기능: F001 (테넌트 인증)
```

## 📄 페이지별 상세 기능

### [로그인 페이지]

| 항목         | 내용                                                                     |
| ------------ | ------------------------------------------------------------------------ |
| 역할         | 사용자 인증 및 병원(테넌트) 컨텍스트 설정                                |
| 진입 경로    | 최초 접속 또는 세션 만료 시 자동 리다이렉트                              |
| 사용자 행동  | 병원 코드 입력 → ID/PW 입력 → 로그인 → JWT 토큰 발급 → 대시보드 이동 |
| 주요 기능    | 병원별 로그인, JWT 토큰 발급, 자동 로그인, 비밀번호 찾기                 |
| 구현 기능 ID | F001                                                                     |

### [대시보드]

| 항목         | 내용                                                         |
| ------------ | ------------------------------------------------------------ |
| 역할         | 오늘의 진료 현황 한눈에 파악 및 빠른 진료 시작               |
| 진입 경로    | 로그인 직후 기본 화면                                        |
| 사용자 행동  | 대기 환자 확인 → 환자 선택 → 진료 시작 또는 재진 예정 확인 |
| 주요 기능    | 대기 환자 목록, 오늘 진료 통계, 재진 예정, 미완성 차트 알림  |
| 구현 기능 ID | F002, F016, F018                                             |

### [환자 대면 차팅]

| 항목         | 내용                                                                                 |
| ------------ | ------------------------------------------------------------------------------------ |
| 역할         | 환자와 함께 보며 진료하는 간소화된 차팅 화면                                         |
| 진입 경로    | 대시보드 > 환자 선택 > 진료 시작                                                     |
| 사용자 행동  | Problem 카드 생성 → 최소 정보 입력 → 환자와 화면 공유하며 설명 → 필요시 상세 입력 |
| 주요 기능    | 간소화 UI, 의학 용어 자동 변환, 시각적 부위 표시, 실시간 저장                        |
| 구현 기능 ID | F031, F034, F005, F032                                                               |

### [Problem Unit 관리]

| 항목         | 내용                                                                |
| ------------ | ------------------------------------------------------------------- |
| 역할         | 문제별 카드 형태로 증상을 관리하고 내원 간 연속성 유지              |
| 진입 경로    | 진료 차트 > Problem 관리 탭                                         |
| 사용자 행동  | 새 문제 생성 또는 기존 문제 선택 → 변화 내용 추가 → 상태 업데이트 |
| 주요 기능    | 문제별 타임라인, 변화 추적, 가설 상태 관리, 복수 문제 동시 관리     |
| 구현 기능 ID | F034, F035                                                          |

### [재진 변화 비교]

| 항목         | 내용                                                        |
| ------------ | ----------------------------------------------------------- |
| 역할         | 이전 내원과 현재 상태를 비교하여 변화 확인                  |
| 진입 경로    | 재진 환자 진료 시 자동 표시 또는 수동 선택                  |
| 사용자 행동  | 이전 기록 확인 → 변화 포인트 입력 → 개선/악화 평가        |
| 주요 기능    | 시계열 비교, 변화 하이라이트, 치료 효과 평가, 그래프 시각화 |
| 구현 기능 ID | F035, F026                                                  |

### [신체검사]

| 항목         | 내용                                                             |
| ------------ | ---------------------------------------------------------------- |
| 역할         | 이학적 검사 결과를 구조화하여 기록                               |
| 진입 경로    | 진료 차트 > 신체검사 탭                                          |
| 사용자 행동  | 검사 항목 선택 → 측정값 입력 → 정상/비정상 판정 → 압통점 마킹 |
| 주요 기능    | ROM 측정, 근력 평가, 특수검사, 압통점 시각화, 템플릿 활용        |
| 구현 기능 ID | F019, F020, F021, F022, F023                                     |

### [환자 설명 모드]

| 항목         | 내용                                                              |
| ------------ | ----------------------------------------------------------------- |
| 역할         | 차팅 내용을 환자가 이해하기 쉬운 형태로 변환하여 표시             |
| 진입 경로    | 진료 중 '환자 설명' 버튼 클릭                                     |
| 사용자 행동  | 설명 모드 전환 → 의학 용어 자동 변환 확인 → 시각 자료 활용 설명 |
| 주요 기능    | 의학 용어 → 일반 용어 변환, 해부학적 그림, 치료 과정 시각화      |
| 구현 기능 ID | F032                                                              |

### [진료 요약 생성]

| 항목         | 내용                                                     |
| ------------ | -------------------------------------------------------- |
| 역할         | 진료 내용을 환자용 요약 문서로 생성                      |
| 진입 경로    | 진료 종료 시 또는 환자 요청 시                           |
| 사용자 행동  | 요약 생성 → 내용 검토 → PDF 생성 → 이메일/문자 전송   |
| 주요 기능    | 자동 요약, 주요 내용 강조, 다음 내원 안내, 주의사항 포함 |
| 구현 기능 ID | F033                                                     |

### [유사 사례 조회]

| 항목         | 내용                                                     |
| ------------ | -------------------------------------------------------- |
| 역할         | 현재 환자와 유사한 과거 케이스를 조회하여 참고           |
| 진입 경로    | 진료 차트 > 유사 사례 보기                               |
| 사용자 행동  | S-T-D 패턴 자동 분석 → 유사도 순 정렬 → 치료 결과 확인 |
| 주요 기능    | 패턴 매칭, 유사도 점수, 치료 성공률, 익명화 표시         |
| 구현 기능 ID | F011                                                     |

### [병원 관리]

| 항목         | 내용                                                       |
| ------------ | ---------------------------------------------------------- |
| 역할         | 병원 정보 및 기본 설정 관리                                |
| 진입 경로    | Admin Console > 병원 설정                                  |
| 사용자 행동  | 병원 정보 입력 → 진료 과목 설정 → 운영 시간 설정 → 저장 |
| 주요 기능    | 병원 정보, 로고 업로드, 진료 시간, 휴진 일정               |
| 구현 기능 ID | F036                                                       |

### [사용자 관리]

| 항목         | 내용                                                    |
| ------------ | ------------------------------------------------------- |
| 역할         | 의료진 및 직원 계정 관리                                |
| 진입 경로    | Admin Console > 사용자 관리                             |
| 사용자 행동  | 사용자 추가 → 정보 입력 → 권한 설정 → 초대 메일 발송 |
| 주요 기능    | 계정 CRUD, 역할 기반 권한, 면허 정보, 활성/비활성       |
| 구현 기능 ID | F014                                                    |

### [증상/부위 마스터 관리]

| 항목         | 내용                                                        |
| ------------ | ----------------------------------------------------------- |
| 역할         | 정형외과 특화 증상 및 해부학적 부위 마스터 데이터 체계 관리 |
| 진입 경로    | Admin Console > 마스터 데이터 관리 > 증상/부위 마스터      |
| 사용자 행동  | 분류 체계 설정 → 항목 추가/수정 → 연관성 설정 → 저장     |
| 주요 기능    | 증상 분류 체계(50개), 부위 세분화(50개), 증상-부위 연관성   |
| 구현 기능 ID | F051, F052, F055                                            |

### [실시간 검색 및 즐겨찾기]

| 항목         | 내용                                                    |
| ------------ | ------------------------------------------------------- |
| 역할         | 차팅 시 증상/부위 빠른 검색 및 개인화 설정              |
| 진입 경로    | 모든 차팅 화면에서 증상/부위 입력 시                    |
| 사용자 행동  | 검색어 입력 → 자동완성 목록 확인 → 선택 → 즐겨찾기 등록 |
| 주요 기능    | 자동완성 검색, 필터링, 즐겨찾기 관리, 사용 빈도 분석    |
| 구현 기능 ID | F053, F054                                              |

### [정형외과 신체검사 템플릿]

| 항목         | 내용                                                        |
| ------------ | ----------------------------------------------------------- |
| 역할         | 부위별 체계적 신체검사 가이드 및 결과 구조화 입력           |
| 진입 경로    | 신체검사 > 부위 선택 > 검사 템플릿 활용                     |
| 사용자 행동  | 부위 선택 → 권장 검사 항목 확인 → 검사 수행 → 결과 입력  |
| 주요 기능    | 부위별 검사 항목, ROM 정상 범위, 특수검사 체크리스트        |
| 구현 기능 ID | F041, F042, F043, F044, F056                                |

### [구조화 영상 판독]

| 항목         | 내용                                                     |
| ------------ | -------------------------------------------------------- |
| 역할         | 영상 소견을 구조화된 양식으로 입력하여 일관성 있는 기록  |
| 진입 경로    | 영상검사 > 판독 입력 > 구조화 양식 선택                  |
| 사용자 행동  | 영상 종류 선택 → 부위별 소견 입력 → 템플릿 활용 → 저장 |
| 주요 기능    | 부위별 판독 양식, 소견 템플릿, 이상 소견 하이라이트      |
| 구현 기능 ID | F047, F048, F049, F050                                   |

### [템플릿 관리]

| 항목         | 내용                                                  |
| ------------ | ----------------------------------------------------- |
| 역할         | 자주 사용하는 증상-부위 조합 및 치료 계획 템플릿 관리 |
| 진입 경로    | Admin Console > 시스템 설정 > 템플릿 관리             |
| 사용자 행동  | 템플릿 생성 → 항목 구성 → 기본값 설정 → 저장       |
| 주요 기능    | 증상 템플릿, 검사 세트, 치료 프로토콜, 순서 조정      |
| 구현 기능 ID | F015                                                  |

### [진료 통계]

| 항목         | 내용                                                 |
| ------------ | ---------------------------------------------------- |
| 역할         | 진료 현황 및 통계를 시각화하여 인사이트 제공         |
| 진입 경로    | Admin Console > 모니터링 > 진료 통계                 |
| 사용자 행동  | 기간 설정 → 필터 적용 → 차트 확인 → 상세 드릴다운 |
| 주요 기능    | 질환별 통계, 의사별 성과, 환자 재진율, 추세 분석     |
| 구현 기능 ID | F016                                                 |

### [데이터 품질 모니터링]

| 항목         | 내용                                                   |
| ------------ | ------------------------------------------------------ |
| 역할         | 진료 기록의 완성도 및 품질 관리                        |
| 진입 경로    | Admin Console > 모니터링 > 데이터 품질                 |
| 사용자 행동  | 품질 지표 확인 → 미완성 목록 조회 → 담당자 알림 발송 |
| 주요 기능    | 완성도 점수, 미완성 차트, ICD 미매핑, 개선 추이        |
| 구현 기능 ID | F018                                                   |

### [요금제 관리]

| 항목         | 내용                                                        |
| ------------ | ----------------------------------------------------------- |
| 역할         | 서비스 구독 및 결제 관리                                    |
| 진입 경로    | Admin Console > 요금제 관리                                 |
| 사용자 행동  | 현재 플랜 확인 → 업그레이드 선택 → 결제 정보 입력 → 구독 |
| 주요 기능    | 요금제 비교, 사용량 확인, 결제 이력, 청구서 다운로드        |
| 구현 기능 ID | F037, F038                                                  |

## 🗄️ 데이터 모델 (요구 수준)

### 핵심 엔티티

- **tenant**: id, name, hospital_code, subscription_plan, status, created_at
- **user**: id, tenant_id, username, password_hash, role, name, license_number, status
- **patient**: id, tenant_id, chart_number, name, birth_date, gender, phone
- **encounter**: id, tenant_id, patient_id, physician_id, encounter_date, status

### 마스터 데이터 엔티티

- **symptom_master**: id, tenant_id, code, name_ko, name_en, category, keywords, is_active, sort_order
- **anatomy_master**: id, tenant_id, code, name_ko, name_en, parent_code, level, keywords, is_active
- **symptom_anatomy_relation**: id, tenant_id, symptom_code, anatomy_code, relevance_score, is_primary
- **user_favorites**: id, tenant_id, user_id, item_type, item_code, usage_count, last_used_at
- **examination_template**: id, tenant_id, anatomy_code, examination_items, normal_ranges, special_tests

### Problem 중심 구조

- **problem_unit**: id, tenant_id, patient_id, problem_name, first_encounter_id, status, created_at
- **problem_history**: id, tenant_id, problem_unit_id, encounter_id, change_type, change_detail
- **problem_snapshot**: id, tenant_id, problem_unit_id, encounter_id, situation_data, treatment_data, duration_data

### S-T-D 구조화 데이터

- **situation_record**: id, tenant_id, encounter_id, problem_unit_id, symptom_code, anatomy_code, onset_date, severity
- **treatment_record**: id, tenant_id, encounter_id, problem_unit_id, treatment_type, treatment_code, hypothesis_status
- **duration_record**: id, tenant_id, encounter_id, problem_unit_id, expected_duration_days, follow_up_date, prognosis

### 검사 데이터

- **physical_examination**: id, tenant_id, encounter_id, anatomy_code, examination_type, status, findings, normal_range, is_abnormal
- **rom_measurement**: id, tenant_id, physical_examination_id, joint_name, motion_type, measured_degree, normal_min, normal_max
- **muscle_strength_test**: id, tenant_id, physical_examination_id, muscle_group, strength_grade, laterality
- **special_test_result**: id, tenant_id, physical_examination_id, test_name, result, interpretation
- **tenderness_point**: id, tenant_id, physical_examination_id, anatomy_location, severity_score, coordinates
- **imaging_order**: id, tenant_id, encounter_id, modality, body_part, urgency, clinical_indication
- **imaging_result**: id, tenant_id, imaging_order_id, structured_findings, impression, abnormal_keywords, comparison_note

### 환자 소통

- **patient_explanation**: id, tenant_id, encounter_id, original_text, simplified_text, visual_aids
- **encounter_summary**: id, tenant_id, encounter_id, summary_content, pdf_url, sent_at

### ICD 매핑

- **encounter_icd_mapping**: id, tenant_id, encounter_id, icd_code, mapping_type, confidence_score
- **icd_master**: id, code, version, name_ko, name_en, symptom_keywords, anatomy_keywords

### Audit & History

- **audit_log**: id, tenant_id, user_id, entity_type, entity_id, action, old_value, new_value, created_at
- **data_history**: id, tenant_id, table_name, record_id, version, change_type, changed_data

### B2B SaaS

- **subscription**: id, tenant_id, plan_type, start_date, end_date, status, payment_method
- **usage_metric**: id, tenant_id, metric_type, value, measured_at
- **backup_history**: id, tenant_id, backup_type, file_path, size_bytes, created_at

## 🧩 Policy Decision Request (정책 결정 요청)

> 아래 항목은 prd-writer가 결론내리지 않으며, clinical-policy-designer의 결정을 기다린다.

| 임시ID    | 관련 기능(Fxxx) | 쟁점                   | 필요한 결정(허용/금지/조건부)                   |
| --------- | --------------- | ---------------------- | ----------------------------------------------- |
| P-REQ-001 | F013            | 진료 기록 수정 시한    | 진료 완료 후 수정 가능 기간 (24시간/7일/무제한) |
| P-REQ-002 | F034            | Problem 병합/분리 규칙 | 유사 문제의 통합 또는 분리 기준                 |
| P-REQ-003 | F008            | ICD 자동 매핑 정확도   | 최소 confidence score 및 수동 확인 필요 수준    |
| P-REQ-004 | F011            | 유사 환자 비식별화     | 타 환자 데이터 표시 시 마스킹 범위              |
| P-REQ-005 | F032            | 의학 용어 변환 수준    | 환자용 설명의 단순화 정도                       |
| P-REQ-006 | F033            | 진료 요약 법적 효력    | 공식 의무기록으로 인정 여부                     |
| P-REQ-007 | F035            | 재진 간격 기준         | 동일 문제로 인정하는 최대 간격 (30일/90일/1년)  |
| P-REQ-008 | F019-F023       | 정상 범위 기준         | 연령/성별별 정상치 설정 방식                    |
| P-REQ-009 | F025            | 영상 판독 권한         | 영상의학과 전문의 외 판독 입력 허용 범위        |
| P-REQ-010 | F017            | Audit 로그 보존        | 법적 최소 보존 기간 (5년/10년)                  |
| P-REQ-011 | F039            | 백업 주기 및 보관      | 자동 백업 주기 및 보관 기간                     |
| P-REQ-012 | F040            | EMR 연동 표준          | 지원할 EMR 시스템 및 데이터 포맷                |
| P-REQ-013 | F036            | 테넌트 데이터 격리     | 물리적/논리적 격리 수준                         |
| P-REQ-014 | F037            | 요금제 변경 정책       | 다운그레이드 시 데이터 처리 방식                |
| P-REQ-015 | F006            | 가설 치료 기록         | 확정되지 않은 치료 계획의 기록 허용 범위        |
| P-REQ-016 | F051, F052      | 증상/부위 표준화 수준  | 병원별 커스터마이징 vs 표준 체계 적용 범위      |
| P-REQ-017 | F055            | 증상-부위 연관성 기준  | 자동 제안 시 relevance score 임계값 설정       |
| P-REQ-018 | F042            | ROM 정상 범위 기준     | 연령/성별/활동성별 정상치 차이 적용 방식        |
| P-REQ-019 | F047            | 구조화 판독 필수 여부  | 자유 텍스트 vs 구조화 입력 비율                 |
| P-REQ-020 | F054            | 즐겨찾기 공유 범위     | 개인별 vs 병원별 vs 진료과별 즐겨찾기 공유      |

## 🔧 기술 스택 (Platform 고정)

- **Frontend**: React + Next.js
- **Backend**: Spring Boot 3.x
- **Persistence**: MariaDB, JPA + Querydsl
- **Auth**: JWT (Custom)
- **Multi-tenancy**: Request-scoped TenantContext + tenant_id 기반 논리 격리
- **Knowledge Base**: ICD-10/11 지식 그래프 + 증상-부위 매핑 엔진
- **Export**: PDF 생성 (진료 요약), Excel/CSV (통계 데이터)
- **Integration**: RESTful API (EMR 연동)

---

*이 PRD는 개인병원의 진료 흐름을 해치지 않으면서 임상 데이터를 구조화하고, 환자가 이해할 수 있는 형태로 설명 가능한 시스템을 정의합니다. MVP 범위는 개인병원 정형외과를 우선 대상으로 하며, 의학적 판단과 정책 결정이 필요한 부분은 P-REQ로 분리하여 추후 확정합니다.*
